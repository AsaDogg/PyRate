<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phase Closure Module &mdash; PyRate 0.6.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Prepifg Helper Module" href="prepifg_helper.html" />
    <link rel="prev" title="Orbital Error Correction Module" href="orbital.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html">
            <img src="_static/PyRate_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    <li><a href="https://geoscienceaustralia.github.io/PyRate/">Home</a></li>
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#platforms">Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#verify-installation">Verify Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#workflow">Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#input-files">Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#parallel-processing">Parallel Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#results-visualisation">Results Visualisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">PyRate Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyrate.conv2tif.html">PyRate Conv2tif Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyrate.prepifg.html">PyRate Prepifg Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyrate.correct.html">PyRate Correct Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyrate.merge.html">PyRate Merge Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyrate.main.html">PyRate Main Script</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">PyRate Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="algorithm.html">Algorithm Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="aps.html">Atmospheric Phase Screen Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="covariance.html">Covariance Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="demerror.html">DEM Error Correction Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gamma.html">GAMMA Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html">Geometry Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="gdal_python.html">GDAL-Python Bindings Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ifgconstants.html">Ifgconstants Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="logger.html">Logging Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpiops.html">MPI operations Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mst.html">Minimum Spanning Tree Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="orbital.html">Orbital Error Correction Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Phase Closure Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="prepifg_helper.html">Prepifg Helper Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref_phs_est.html">Reference Phase Calculation Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="refpixel.html">Reference Pixel Calculation Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="roipac.html">ROI_PAC Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared.html">Shared Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="stack.html">Stacking Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeseries.html">Time Series Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#valueerror-too-many-values-to-unpack-expected-2">ValueError: too many values to unpack (expected 2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#stack-rate-map-appears-to-be-blank-empty">Stack Rate map appears to be blank/empty</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#failure-of-aps-spatial-low-pass-filter">Failure of APS spatial low pass filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#out-of-memory-errors">Out of memory errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#incorrect-modules-loaded-on-gadi">Incorrect modules loaded on Gadi</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#types-of-contributions">Types of Contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#pull-request-guidelines">Pull Request Guidelines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authors.html#development-lead">Development Lead</a></li>
<li class="toctree-l2"><a class="reference internal" href="authors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Release History</a><ul>
<li class="toctree-l2"><a class="reference internal" href="history.html#id1">0.6.0 (2021-10-18)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id2">0.5.0 (2020-09-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id7">0.4.3 (2020-08-04)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id12">0.4.2 (2020-06-26)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id17">0.4.1 (2020-05-19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id22">0.4.0 (2019-10-31)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id26">0.3.0 (2019-07-26)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id31">0.2.0 (2017-05-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="history.html#id32">0.1.0 (2017-01-31)</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyRate</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">PyRate Modules</a> &raquo;</li>
      <li>Phase Closure Module</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="orbital.html" class="btn btn-neutral float-left" title="Orbital Error Correction Module" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="prepifg_helper.html" class="btn btn-neutral float-right" title="Prepifg Helper Module" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="phase-closure-module">
<h1>Phase Closure Module<a class="headerlink" href="#phase-closure-module" title="Permalink to this headline">¶</a></h1>
<p>The phase closure functionality in PyRate is designed to identify and mitigate the
effects of spatial unwrapping errors in the input interferograms (ifgs).
Identification is by forming “closure loops” between sets of ifgs and then
summing the phase in this closed loop for each pixel. Theoretically, the closure
phase should be equal to zero, though in reality, close to zero is good enough.
An unwrapping error in one of the loop edges will manifest as a closure phase of
n<em>2</em>pi radians.
By forming many loops amongst a network of ifgs, we attempt to identify
the individual ifgs that are contributing the unwrapping error.
Once identified, the unwrapping errors are mitigated by masking those pixels in
the necessary (but not all) ifgs.</p>
<p>By default, PyRate will do the phase closure step after orbital error, reference
phase and DEM error correction steps.
If a user wants to change the order of the corrections during PyRate’s <code class="docutils literal notranslate"><span class="pre">correct</span></code>
step, copy and paste the following code-block in to the PyRate configuration file
and re-order the steps. This will over-ride the default behaviour.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">correct</span><span class="p">]</span>
<span class="n">steps</span> <span class="o">=</span>
    <span class="n">orbfit</span>
    <span class="n">refphase</span>
    <span class="n">demerror</span>
    <span class="n">phase_closure</span>
    <span class="n">mst</span>
    <span class="n">apscorrect</span>
    <span class="n">maxvar</span>
</pre></div>
</div>
<p>Five parameters control the phase closure functionality in PyRate.
These are described in the example PyRate configuration file
_input<em>parameters.conf</em> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#------------------------------------</span>
<span class="c1"># Phase closure correction parameters</span>

<span class="c1"># closure_thr:         Closure threshold for each pixel in multiples of pi, e.g. 0.5 = pi/2, 1 = pi.</span>
<span class="c1"># ifg_drop_thr:        Ifgs with more than this fraction of pixels above the closure threshold in all</span>
<span class="c1">#                      loops it participates in, will be dropped entirely.</span>
<span class="c1"># min_loops_per_ifg:   Ifgs are dropped entirely if they do not participate in at least this many closure loops.</span>
<span class="c1"># max_loop_length:     Closure loops with up to this many edges will be used.</span>
<span class="c1"># max_loop_redundancy: A closure loop will be discarded if all constituent ifgs in that loop have</span>
<span class="c1">#                      already contributed to a number of loops equal to this parameter.</span>
<span class="n">closure_thr</span><span class="p">:</span>         <span class="mf">0.5</span>
<span class="n">ifg_drop_thr</span><span class="p">:</span>        <span class="mf">0.05</span>
<span class="n">min_loops_per_ifg</span><span class="p">:</span>   <span class="mi">2</span>
<span class="n">max_loop_length</span><span class="p">:</span>     <span class="mi">4</span>
<span class="n">max_loop_redundancy</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<p>The PyRate <em>phase closure</em> algorithm proceeds as follows:</p>
<ol class="arabic simple">
<li><p>Find the closed loops within the given ifg network having edges less than or
equal to the parameter <code class="docutils literal notranslate"><span class="pre">max_loop_length</span></code>. This is done in the function
<code class="docutils literal notranslate"><span class="pre">mst_closure.sort_loops_based_on_weights_and_date</span></code>.
We perform several steps in this stage:</p>
<ul class="simple">
<li><p>Find closed loops with edges numbering between 3 and <code class="docutils literal notranslate"><span class="pre">max_loop_length</span></code>.
(function <code class="docutils literal notranslate"><span class="pre">mst_closure.__find_closed_loops</span></code>)</p></li>
<li><p>Sort ifgs within each loop based on first date (earlier date first).
In case of a tie, we sort based on the second date. We then compute
weight of each ifg as the temporal baseline in days.
Then we sum the ifg weights in a loop to give the weight of each closure loop
(function <code class="docutils literal notranslate"><span class="pre">mst_closure.__add_signs_and_weights_to_loops</span></code>).</p></li>
<li><p>Sort the loops based on their weights, and in case of ties, further
sort by primary date, and secondary date.
(function <code class="docutils literal notranslate"><span class="pre">mst_closure.sort_loops_based_on_weights_and_date</span></code>)</p></li>
</ul>
</li>
<li><p>Discard closure loops when all of the constituent ifgs have already contributed
to a number of loops equalling the <code class="docutils literal notranslate"><span class="pre">max_loop_redundancy</span></code> parameter.
(function <code class="docutils literal notranslate"><span class="pre">closure_check.discard_loops_containing_max_ifg_count</span></code>)</p></li>
<li><p>Drop ifgs from further PyRate processing when they are found to not form part
of any closed loop.
(function <code class="docutils literal notranslate"><span class="pre">closure_check.__drop_ifgs_if_not_part_of_any_loop</span></code>)</p></li>
<li><p>Compute phase closure sums for each pixel (in radians) in all the chosen loops
and flag when the resultant absolute sum exceeds the quantity &lt;<code class="docutils literal notranslate"><span class="pre">closure_thr</span></code> * pi&gt;.
The median closure sum across all pixels is subtracted from the closure phase
(optional parameter <code class="docutils literal notranslate"><span class="pre">subtract_median</span></code>, which is on by default).
(function <code class="docutils literal notranslate"><span class="pre">sum_closure.__compute_ifgs_breach_count</span></code>)</p></li>
<li><p>Next, ifgs are dropped (removed from the processing list) if the fraction of
constituent pixels breaching the <code class="docutils literal notranslate"><span class="pre">closure_thr</span></code> parameter in all loops
the ifg participates in exceeds the parameter <code class="docutils literal notranslate"><span class="pre">ifg_drop_thr</span></code>, or the ifg
does not contribute to a number of loops at least equal to the parameter
<code class="docutils literal notranslate"><span class="pre">min_loops_per_ifg</span></code>.
(function <code class="docutils literal notranslate"><span class="pre">closure_check.__drop_ifgs_exceeding_threshold</span></code>)</p></li>
<li><p>Steps 1-5 are repeated iteratively until a stable list of ifgs is returned.
The iteration is orchestrated by the function <code class="docutils literal notranslate"><span class="pre">closure_check.iterative_closure_check</span></code>.</p></li>
<li><p>Once a stable list of ifgs is found, a new ifglist is written in the working
directory, and used for further PyRate processing.</p></li>
<li><p>The final step involves finding pixels in the ifg phase data that breach the
closure threshold defined by the <code class="docutils literal notranslate"><span class="pre">closure_thr</span></code> parameter. Those pixels in breach
are masked (changed to NaN value) for those pixels in those ifgs.
(function <code class="docutils literal notranslate"><span class="pre">closure_check.mask_pixels_with_unwrapping_errors</span></code>)</p></li>
</ol>
<section id="example-usage">
<h2>Example usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>To illustrate the PyRate phase closure functionality, we use a small example dataset
of 8 Sentinel-1 ifgs which connect 5 common acquisition dates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">20160314</span><span class="o">-</span><span class="mi">20160326</span>
<span class="mi">20160314</span><span class="o">-</span><span class="mi">20160407</span>
<span class="mi">20160314</span><span class="o">-</span><span class="mi">20160501</span>
<span class="mi">20160326</span><span class="o">-</span><span class="mi">20160407</span>
<span class="mi">20160326</span><span class="o">-</span><span class="mi">20160513</span>
<span class="mi">20160407</span><span class="o">-</span><span class="mi">20160501</span>
<span class="mi">20160407</span><span class="o">-</span><span class="mi">20160513</span>
<span class="mi">20160501</span><span class="o">-</span><span class="mi">20160513</span>
</pre></div>
</div>
<p>The below plots show the ifgs following <code class="docutils literal notranslate"><span class="pre">prepifg</span></code>:</p>
<a class="reference external image-reference" href="./phase_closure_images/ifg-phase-plot-1-before.png"><img alt="Ifgs before phase closure correction" src="_images/ifg-phase-plot-1-before.png" /></a>
<p>Circled in black are some visually obvious unwrapping errors.</p>
<p>In this example, we run the <code class="docutils literal notranslate"><span class="pre">correct</span></code> step with orbital correction and phase
closure correction enabled, and the following parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">orbfitmethod</span><span class="p">:</span>  <span class="mi">2</span>
<span class="n">orbfitdegrees</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">orbfitlksx</span><span class="p">:</span>    <span class="mi">10</span>
<span class="n">orbfitlksy</span><span class="p">:</span>    <span class="mi">10</span>

<span class="n">closure_thr</span><span class="p">:</span>         <span class="mf">0.5</span>
<span class="n">ifg_drop_thr</span><span class="p">:</span>        <span class="mf">0.1</span>
<span class="n">min_loops_per_ifg</span><span class="p">:</span>   <span class="mi">2</span>
<span class="n">max_loop_length</span><span class="p">:</span>     <span class="mi">4</span>
<span class="n">max_loop_redundancy</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<p>We get the following log information from iteration #1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">45</span> <span class="n">closure_check</span><span class="p">:</span><span class="mi">126</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="n">Closure</span> <span class="n">check</span> <span class="n">iteration</span> <span class="c1">#1: working on 8 ifgs</span>
<span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">45</span> <span class="n">closure_check</span><span class="p">:</span><span class="mi">187</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">closed</span> <span class="n">loops</span> <span class="k">with</span> <span class="n">up</span> <span class="n">to</span> <span class="n">MAX_LOOP_LENGTH</span> <span class="o">=</span> <span class="mi">4</span> <span class="n">edges</span> <span class="ow">is</span> <span class="mi">9</span>
<span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">45</span> <span class="n">closure_check</span><span class="p">:</span><span class="mi">202</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="n">After</span> <span class="n">applying</span> <span class="n">MAX_LOOP_REDUNDANCY</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">criteria</span><span class="p">,</span> <span class="mi">8</span> <span class="n">loops</span> <span class="n">are</span> <span class="n">retained</span>
<span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="n">plot_closure</span><span class="p">:</span><span class="mi">76</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="mi">8</span> <span class="n">closure</span> <span class="n">loops</span> <span class="n">plotted</span> <span class="ow">in</span> <span class="n">out</span><span class="o">/</span><span class="n">phase_closure_dir</span><span class="o">/</span><span class="n">closure_loops_iteration_1_fig_0</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<a class="reference external image-reference" href="./phase_closure_images/closure_loops_iteration_1_fig_0.png"><img alt="Iteration #1 closure loops" src="_images/closure_loops_iteration_1_fig_0.png" /></a>
<p>The 8 plotted closure loops from iteration #1 show areas where the <code class="docutils literal notranslate"><span class="pre">closure_thr</span></code>
threshold has been breached as either dark red or dark blue. The previously
circled unwrapping errors show up as breached areas in several closure loops.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ifg_drop_thr</span></code> parameter is set to 10% in this example. This is enough
to detect the largest mis-closed area, which amounts to around 25% of the phase
data area spatially. The ifg introducing this mis-closure (20160407-20160513)
is dropped and iteration #2 continues:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="n">closure_check</span><span class="p">:</span><span class="mi">126</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="n">Closure</span> <span class="n">check</span> <span class="n">iteration</span> <span class="c1">#2: working on 7 ifgs</span>
<span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="n">closure_check</span><span class="p">:</span><span class="mi">187</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">selected</span> <span class="n">closed</span> <span class="n">loops</span> <span class="k">with</span> <span class="n">up</span> <span class="n">to</span> <span class="n">MAX_LOOP_LENGTH</span> <span class="o">=</span> <span class="mi">4</span> <span class="n">edges</span> <span class="ow">is</span> <span class="mi">5</span>
<span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="n">closure_check</span><span class="p">:</span><span class="mi">202</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="n">After</span> <span class="n">applying</span> <span class="n">MAX_LOOP_REDUNDANCY</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">criteria</span><span class="p">,</span> <span class="mi">5</span> <span class="n">loops</span> <span class="n">are</span> <span class="n">retained</span>
<span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">58</span> <span class="n">plot_closure</span><span class="p">:</span><span class="mi">76</span> <span class="mi">421776</span> <span class="n">INFO</span> <span class="mi">0</span><span class="o">/</span><span class="mi">7</span> <span class="mi">5</span> <span class="n">closure</span> <span class="n">loops</span> <span class="n">plotted</span> <span class="ow">in</span> <span class="n">out</span><span class="o">/</span><span class="n">phase_closure_dir</span><span class="o">/</span><span class="n">closure_loops_iteration_2_fig_0</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<a class="reference external image-reference" href="./phase_closure_images/closure_loops_iteration_2_fig_0.png"><img alt="Iteration #2 closure loops" src="_images/closure_loops_iteration_2_fig_0.png" /></a>
<p>Now the ifg network is smaller (7 ifgs) and less closure loops (5) are retained.
Three smaller breached areas are evident: in the top left, centre bottom and
bottom right of the image. The average breached area is now not greater than 10%
so no further ifgs are fully dropped and no further iteration is required.</p>
<p>Finally, pixels found to be breaching the <code class="docutils literal notranslate"><span class="pre">closure_thr</span></code> are masked in ifgs:</p>
<a class="reference external image-reference" href="./phase_closure_images/ifg-phase-plot-1-after.png"><img alt="Ifgs after phase closure correction" src="_images/ifg-phase-plot-1-after.png" /></a>
<p>The previously circled unwrapping error in ifg 20160314-20160501 has now been
masked, but this spatial area has not been masked in other ifgs. In this case,
the algorithm has been successfully able to attribute the source of the unwrapping
error to this single ifg. The ability to do this depends on the parameter
settings chosen.</p>
<span class="target" id="module-pyrate.core.phase_closure.collect_loops"></span><dl class="py function">
<dt class="sig sig-object py" id="pyrate.core.phase_closure.collect_loops.dedupe_loops">
<span class="sig-prename descclassname"><span class="pre">pyrate.core.phase_closure.collect_loops.</span></span><span class="sig-name descname"><span class="pre">dedupe_loops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span></span></span><a class="reference internal" href="_modules/pyrate/core/phase_closure/collect_loops.html#dedupe_loops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrate.core.phase_closure.collect_loops.dedupe_loops" title="Permalink to this definition">¶</a></dt>
<dd><p>Deduplication of loops with same members.</p>
<p>For example: for nodes 1, 2, 3 in the graph below</p>
<blockquote>
<div><dl class="simple">
<dt>[</dt><dd><p>[0, 1, 1],
[1, 0, 1],
[1, 1, 0],</p>
</dd>
</dl>
<p>]</p>
</div></blockquote>
<p>Loops of length 3 are 0-&gt;1-&gt;2 and 0-&gt;2-&gt;1. We only retain 1 of these loops after dedupe.</p>
<p>Example 2:
For the following graph:</p>
<blockquote>
<div><dl class="simple">
<dt>[</dt><dd><p>[0, 1, 1, 1],
[1, 0, 1, 1],
[1, 1, 0, 1],
[1, 1, 1, 0],</p>
</dd>
</dl>
<p>]</p>
</div></blockquote>
<p>Pictorially this is the network
1 ———2
| *      * |
|    *     |
|  *    *  |
4———-3</p>
<dl class="simple">
<dt>Loops of length 4 are:</dt><dd><p>[[0, 1, 2, 3], [0, 1, 3, 2], [0, 2, 1, 3], [0, 2, 3, 1], [0, 3, 1, 2], [0, 3, 2, 1]]</p>
</dd>
</dl>
<p>After deduplication we will only retain [0, 1, 2, 3]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrate.core.phase_closure.collect_loops.dfs">
<span class="sig-prename descclassname"><span class="pre">pyrate.core.phase_closure.collect_loops.</span></span><span class="sig-name descname"><span class="pre">dfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marked</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_loops</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrate/core/phase_closure/collect_loops.html#dfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrate.core.phase_closure.collect_loops.dfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth First Search algorithm to count loops of length n in a given graph.
Adapted from <a class="reference external" href="https://www.geeksforgeeks.org/print-all-the-cycles-in-an-undirected-graph/">https://www.geeksforgeeks.org/print-all-the-cycles-in-an-undirected-graph/</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyrate.core.phase_closure.collect_loops.find_loops">
<span class="sig-prename descclassname"><span class="pre">pyrate.core.phase_closure.collect_loops.</span></span><span class="sig-name descname"><span class="pre">find_loops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrate/core/phase_closure/collect_loops.html#find_loops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyrate.core.phase_closure.collect_loops.find_loops" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts and collects loops of a defined length in an undirected and connected graph</p>
</dd></dl>

<span class="target" id="module-pyrate.core.phase_closure.correct_phase"></span></section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Geoscience Australia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<p>placeHolderText</p>
        <!-- your html code here -->
 


</body>
</html>