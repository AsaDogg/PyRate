# docker cleanup https://docs.docker.com/ee/dtr/user/manage-images/delete-images/
# Docker Setup
git clone git@github.com:GeoscienceAustralia/PyRate.git --single-branch --branch  sheece-rm-luigi-ref
cd PyRate
docker build -t pyrate-image:1.0 .
docker run -it --rm -v %cd%:/PyRate pyrate-image:1.0 /bin/bash

# build PyRate package
cd /PyRate && python3 setup.py install

# Run workflow
pyrate prepifg pyrate_gamma.conf
pyrate linrate pyrate_gamma.conf -c 3 -r 4
pyrate postprocess pyrate_gamma.conf -c 3 -r 4

# Build Sphinx docs
cd /PyRate/docs && make html

chmod 444 tests/test_data/small_test/tif/geo_070709-070813_unw.tif
cd PyRate
pip3 install -r requirements-tests.txt
python3 -m pytest tests/
pip install tox
tox